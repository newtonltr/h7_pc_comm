# H7 IP设置工具

该上位机用来配置H7设备的网络参数。

## 功能介绍

这个工具主要能做这几件事：

### 通信方式
- **串口通信**：支持常见的串口参数配置（波特率、数据位、校验位等）
- **网络通信**：通过TCP Socket连接设备，适合已经联网的设备

### 设备配置
- **MAC地址设置**：可以修改设备MAC地址的高字节部分
- **IP地址配置**：直接设置设备的IP地址

### 调试功能
- **数据监控**：实时查看收发的数据包
- **格式选择**：支持HEX、ASCII、混合显示模式
- **日志保存**：可以把调试日志保存到文件

界面分成两个标签页，左边是配置面板，右边是调试信息。

## 开发环境

我用的是：
- Qt 6.8.0
- MinGW 64位编译器
- Windows 10

理论上Qt 5.x版本应该也能编译，不过没试过。如果你用的是Linux或者macOS，可能需要稍微调整一下。

## 编译运行

### 准备工作
确保你的机器上安装了：
- Qt开发环境（建议6.0以上版本）
- C++17支持的编译器

### 编译步骤
```bash
# 克隆项目
git clone <项目地址>
cd h7_ipset

# 用qmake生成Makefile
qmake h7_ipset.pro

# 编译
make
```

或者直接用Qt Creator打开`h7_ipset.pro`文件，点击运行就行了。

## 使用指南

### 串口连接
1. 在"通信方式"里选择"串口通信"
2. 选择正确的串口号（如果没有显示，点击"刷新"按钮）
3. 设置波特率等参数（一般默认的9600就可以）
4. 点击"连接"

### 网络连接
1. 选择"网络通信"
2. 输入设备的IP地址和端口号
3. 调整超时时间（网络不好的话可以设长一点）
4. 点击"连接"

### 设置MAC地址
连接成功后，在右侧的"MAC地址设置"区域：
1. 输入MAC地址的高字节值（0-255）
2. 下方会实时显示完整的MAC地址
3. 点击"设置MAC"发送命令

### 设置IP地址
在"IP地址设置"区域：
1. 输入新的IP地址（格式：192.168.1.100）
2. 点击"设置IP"

所有的操作过程都可以在"调试信息"标签页看到，包括发送的命令和设备的响应。

## 项目结构

代码按功能分了几个目录：

```
h7_ipset/
├── communication/          # 通信模块
│   ├── serial_thread.*     # 串口通信线程
│   └── socket_thread.*     # 网络通信线程
├── protocol/               # 协议处理
│   └── protocol_frame.*    # 协议帧封装和解析
├── ui/                     # 界面组件
│   ├── config_widget.*     # 配置界面
│   └── debug_widget.*      # 调试界面
├── main.cpp               # 程序入口
├── mainwindow.*           # 主窗口
└── pc_protocol.*          # 底层协议实现
```

## 注意事项

1. **权限问题**：在某些系统上，串口操作可能需要管理员权限
2. **防火墙**：网络通信时注意防火墙设置
3. **设备兼容性**：目前主要针对H7系列设备测试，其他设备可能需要调整协议部分

## 许可证


---

